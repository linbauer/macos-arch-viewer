<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<title>macOS Architecture Tree</title>
<style>
  body {
    background-color: #ffffff;
    color: #111111;
    margin: 0;
    overflow: hidden;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  }
  .node circle {
    stroke: #000;
    stroke-width: 1.5px;
  }
  .node text {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    fill: #111111;
  }
  .link {
    fill: none;
    stroke: #999;
    stroke-opacity: 0.4;
    stroke-width: 1.5px;
  }
  #legend {
    position: fixed;
    top: 10px;
    right: 10px;
    background: #f4f4f4;
    padding: 10px;
    border-radius: 8px;
    font-size: 12px;
    color: #111111;
    line-height: 1.6;
  }
</style>
<body>
<div id="legend">
  <strong>Legend</strong><br>
  <span style="color:#9b59b6;">■</span> Hardware<br>
  <span style="color:#16a085;">■</span> Kernel (XNU)<br>
  <span style="color:#2980b9;">■</span> Boot & Firmware<br>
  <span style="color:#c0392b;">■</span> Logging & Audit<br>
  <span style="color:#8e44ad;">■</span> Security Architecture<br>
  <span style="color:#f39c12;">■</span> System Frameworks<br>
  <span style="color:#e74c3c;">■</span> User-Space Processes<br>
  <span style="color:#3498db;">■</span> Applications & GUI<br>
  <span style="color:#d35400;">■</span> Forensics & Monitoring<br>
  <span style="color:#7f8c8d;">■</span> Observability Tools<br>
  <span style="color:#1abc9c;">■</span> Networking Stack
</div>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
const colorMap = {
  "Hardware": "#9b59b6",
  "Kernel (XNU)": "#16a085",
  "Boot & Firmware": "#2980b9",
  "Launch Infrastructure": "#2980b9",
  "Logging & Audit": "#c0392b",
  "Security Architecture": "#8e44ad",
  "System Frameworks": "#f39c12",
  "User-Space Processes": "#e74c3c",
  "Applications & GUI": "#3498db",
  "Forensics & Monitoring": "#d35400",
  "Observability Tools": "#7f8c8d",
  "Networking Stack": "#1abc9c"
};

const treeData = {
  "name": "macOS System Architecture",
  "children": [
    {
      "name": "macOS System Architecture",
      "children": [],
      "category": null
    },
    {
      "name": "- Hardware",
      "children": [
        {
          "name": "- CPU & SoC",
          "children": [
            {
              "name": "- Apple Silicon",
              "children": [
                {
                  "name": "- M1",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- M2",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- M3",
                  "children": [],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            },
            {
              "name": "- Intel x86_64",
              "children": [],
              "category": "Hardware"
            },
            {
              "name": "- Performance Cores",
              "children": [],
              "category": "Hardware"
            },
            {
              "name": "- Efficiency Cores",
              "children": [],
              "category": "Hardware"
            }
          ],
          "category": "Hardware"
        },
        {
          "name": "- Memory",
          "children": [
            {
              "name": "- Unified Memory Architecture",
              "children": [],
              "category": "Hardware"
            },
            {
              "name": "- Virtual Memory",
              "children": [],
              "category": "Hardware"
            },
            {
              "name": "- Memory Controller",
              "children": [],
              "category": "Hardware"
            }
          ],
          "category": "Hardware"
        },
        {
          "name": "- Storage",
          "children": [
            {
              "name": "- NVMe SSD",
              "children": [],
              "category": "Hardware"
            },
            {
              "name": "- APFS Volume Structure",
              "children": [],
              "category": "Hardware"
            },
            {
              "name": "- Secure Enclave (SEP)",
              "children": [],
              "category": "Hardware"
            }
          ],
          "category": "Hardware"
        },
        {
          "name": "- Peripheral Interfaces",
          "children": [
            {
              "name": "- T2 Chip",
              "children": [
                {
                  "name": "- Secure Boot",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Disk Encryption",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Audio Processing",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Camera Image Signal Processing",
                  "children": [],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            },
            {
              "name": "- USB Stack",
              "children": [
                {
                  "name": "- XHCI",
                  "children": [
                    {
                      "name": "- USB 3.x Support",
                      "children": [],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Asynchronous Transfer Engine",
                      "children": [],
                      "category": "Hardware"
                    }
                  ],
                  "category": "Hardware"
                },
                {
                  "name": "- UHCI",
                  "children": [
                    {
                      "name": "- USB 1.1 Support",
                      "children": [],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Low-speed Device Handling",
                      "children": [],
                      "category": "Hardware"
                    }
                  ],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            },
            {
              "name": "- Thunderbolt",
              "children": [
                {
                  "name": "- Display Output",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- High-speed Data Transfer",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Daisy-Chaining",
                  "children": [],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            },
            {
              "name": "- Bluetooth Controller",
              "children": [
                {
                  "name": "- BLE (Low Energy)",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Audio Devices (AirPods, etc.)",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Input Devices",
                  "children": [],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            },
            {
              "name": "- Wi-Fi Controller",
              "children": [
                {
                  "name": "- 802.11ax (Wi-Fi 6)",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- MIMO Support",
                  "children": [],
                  "category": "Hardware"
                },
                {
                  "name": "- Network Stack Offload",
                  "children": [],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            },
            {
              "name": "- PCIe )",
              "children": [
                {
                  "name": "- Architecture",
                  "children": [
                    {
                      "name": "- Lane Configuration (x1, x4, x8, x16)",
                      "children": [
                        {
                          "name": "- Bandwidth Differences",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Common Uses",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Gen Versions (Gen3, Gen4, Gen5)",
                      "children": [
                        {
                          "name": "- Data Rates per Lane",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Backward Compatibility",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Switches and Bridges",
                      "children": [
                        {
                          "name": "- Multi-GPU Configurations",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Device Fanout",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    }
                  ],
                  "category": "Hardware"
                },
                {
                  "name": "- Use Cases",
                  "children": [
                    {
                      "name": "- GPU Interface",
                      "children": [
                        {
                          "name": "- Discrete Graphics Cards",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- External GPU (eGPU) Support",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- NVMe SSD Interface",
                      "children": [
                        {
                          "name": "- High-Speed Storage",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Direct CPU Access",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Network Cards (Ethernet, Wi-Fi)",
                      "children": [
                        {
                          "name": "- 10GbE & 40GbE Adapters",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Wi-Fi 6E Modules",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Expansion Cards",
                      "children": [
                        {
                          "name": "- Capture Cards",
                          "children": [
                            {
                              "name": "- Video Input Standards (HDMI, SDI)",
                              "children": [],
                              "category": "Hardware"
                            },
                            {
                              "name": "- Streaming Applications",
                              "children": [],
                              "category": "Hardware"
                            }
                          ],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Sound Cards",
                          "children": [
                            {
                              "name": "- DAC/ADC Processing",
                              "children": [],
                              "category": "Hardware"
                            },
                            {
                              "name": "- Surround Sound Support",
                              "children": [],
                              "category": "Hardware"
                            }
                          ],
                          "category": "Hardware"
                        },
                        {
                          "name": "- RAID Controllers",
                          "children": [
                            {
                              "name": "- Hardware RAID Levels",
                              "children": [],
                              "category": "Hardware"
                            },
                            {
                              "name": "- Battery Backup Units",
                              "children": [],
                              "category": "Hardware"
                            }
                          ],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    }
                  ],
                  "category": "Hardware"
                },
                {
                  "name": "- Protocol Layers",
                  "children": [
                    {
                      "name": "- Physical Layer",
                      "children": [
                        {
                          "name": "- Electrical Signaling",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Connectors and Cables",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Data Link Layer",
                      "children": [
                        {
                          "name": "- Error Detection (CRC)",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Acknowledgment Protocols",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Transaction Layer",
                      "children": [
                        {
                          "name": "- Packetized Data",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Flow Control",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    }
                  ],
                  "category": "Hardware"
                },
                {
                  "name": "- Advanced Features",
                  "children": [
                    {
                      "name": "- Hot-Plug Support",
                      "children": [
                        {
                          "name": "- Live Hardware Replacement",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- OS Support Requirements",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- Power Management (ASPM)",
                      "children": [
                        {
                          "name": "- L0s and L1 States",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Energy Efficiency",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    },
                    {
                      "name": "- SR-IOV",
                      "children": [
                        {
                          "name": "- Virtual Functions (VFs)",
                          "children": [],
                          "category": "Hardware"
                        },
                        {
                          "name": "- Use in Virtualization Environments",
                          "children": [],
                          "category": "Hardware"
                        }
                      ],
                      "category": "Hardware"
                    }
                  ],
                  "category": "Hardware"
                }
              ],
              "category": "Hardware"
            }
          ],
          "category": "Hardware"
        }
      ],
      "category": "Hardware"
    },
    {
      "name": "- Kernel (XNU)",
      "children": [
        {
          "name": "- Mach Layer",
          "children": [
            {
              "name": "- Threads",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Tasks",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Scheduler",
              "children": [
                {
                  "name": "- Real-Time Scheduling",
                  "children": [],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Priority Inversion",
                  "children": [],
                  "category": "Kernel (XNU)"
                }
              ],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Priorities",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Virtual Memory Management",
              "children": [
                {
                  "name": "- Mach VM APIs",
                  "children": [],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Memory Sharing",
                  "children": [],
                  "category": "Kernel (XNU)"
                }
              ],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Memory Objects",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Mach Traps",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Mach IPC",
              "children": [
                {
                  "name": "- Mach Ports",
                  "children": [
                    {
                      "name": "- Receive Rights",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Send Rights",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Port Sets",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Port Notifications",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Mach Messages",
                  "children": [
                    {
                      "name": "- Headers & Trailers",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- OOL Descriptors",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- MIG",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- IPC Subsystems",
                  "children": [
                    {
                      "name": "- MIG",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- XPC",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- IOKit Messaging",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Synchronization & Notifications",
                  "children": [
                    {
                      "name": "- Semaphore IPC",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Lock Sets",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Thread Wakeups",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Memory Transfer Mechanisms",
                  "children": [
                    {
                      "name": "- Copy-on-Write Regions",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Out-of-Line Memory",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Shared Memory",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Security & Namespaces",
                  "children": [
                    {
                      "name": "- Port Namespaces",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Port Right Types",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Audit Tokens",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                }
              ],
              "category": "Kernel (XNU)"
            }
          ],
          "category": "Kernel (XNU)"
        },
        {
          "name": "- BSD Layer",
          "children": [
            {
              "name": "- POSIX API Surface",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Process Management",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- User Management",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- File System Interface",
              "children": [
                {
                  "name": "- vnode layer",
                  "children": [],
                  "category": "Kernel (XNU)"
                }
              ],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Network Stack Integration",
              "children": [],
              "category": "Kernel (XNU)"
            }
          ],
          "category": "Kernel (XNU)"
        },
        {
          "name": "- Kernel Interfaces",
          "children": [
            {
              "name": "- System Calls",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- syscall table",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- sysctl",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- kqueue",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- dtrace probe points",
              "children": [],
              "category": "Kernel (XNU)"
            }
          ],
          "category": "Kernel (XNU)"
        },
        {
          "name": "- IOKit Layer",
          "children": [
            {
              "name": "- Device Matching",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- I/O Registry",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- DriverKit Bridge",
              "children": [],
              "category": "Kernel (XNU)"
            },
            {
              "name": "- Kernel Extensions",
              "children": [
                {
                  "name": "- KEXT Fundamentals",
                  "children": [
                    {
                      "name": "- Purpose: extend kernel functionality (drivers, file systems, filters)",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Written in C++ (I/O Kit based)",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Loaded via kextload / kextunload",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Interact via Mach ports, device interfaces, IOKit",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- KEXT Lifecycle Management",
                  "children": [
                    {
                      "name": "- Load/Unload triggers",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Registration with IOKit",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Interaction with user-space",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- kextstat, kextcache, kextload",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Kernel panics on failure",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Security Hardening & Policy",
                  "children": [
                    {
                      "name": "- System Integrity Protection (SIP) restrictions",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Secure boot + authenticated kext loading",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Signed with Apple-approved developer ID (KEXT Signing)",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Kernel extension policy database",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- User approval on modern macOS",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Deprecation & Transition",
                  "children": [
                    {
                      "name": "- Deprecated since macOS 10.15 (Catalina)",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- System Extensions as user-space alternative",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- DriverKit for hardware support",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- EndpointSecurity for event monitoring",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- System Extensions",
                  "children": [
                    {
                      "name": "- DriverKit",
                      "children": [
                        {
                          "name": "- Enables user-space drivers",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Uses IOKitUser and Mach-based IPC",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Ties into SystemExtension.framework",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Powers USB, HID, and network drivers",
                          "children": [],
                          "category": "Kernel (XNU)"
                        }
                      ],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- EndpointSecurity Extensions",
                      "children": [
                        {
                          "name": "- Uses EndpointSecurity.framework",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Sandboxed event consumers (es_logger, es_consume)",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Monitors system events (exec, open, fork, etc.)",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Requires entitlement: com.apple.developer.endpoint-security.client",
                          "children": [],
                          "category": "Kernel (XNU)"
                        }
                      ],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Network Extensions",
                      "children": [
                        {
                          "name": "- DNS Proxy Providers",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Packet Tunnel Providers",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Content Filter Providers",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- App Proxy Providers",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Part of NetworkExtension.framework",
                          "children": [],
                          "category": "Kernel (XNU)"
                        }
                      ],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- SystemExtension.framework",
                      "children": [
                        {
                          "name": "- Controls lifecycle of extensions",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Interacts with systemextensionsctl",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Requires MDM approval for installation in enterprise contexts",
                          "children": [],
                          "category": "Kernel (XNU)"
                        }
                      ],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Activation Policy & Security",
                      "children": [
                        {
                          "name": "- Activation options: Always, On-Demand, User-Approved",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Bound to Team ID and Code Signing",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- Removal via systemextensionsctl reset",
                          "children": [],
                          "category": "Kernel (XNU)"
                        }
                      ],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                },
                {
                  "name": "- Diagnostics & Observability",
                  "children": [
                    {
                      "name": "- Kernel panics caused by KEXTs",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Tools",
                      "children": [
                        {
                          "name": "- kextutil",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- kextlibs",
                          "children": [],
                          "category": "Kernel (XNU)"
                        },
                        {
                          "name": "- kextcache",
                          "children": [],
                          "category": "Kernel (XNU)"
                        }
                      ],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- /Library/Extensions vs /System/Library/Extensions",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Console logs & crash logs",
                      "children": [],
                      "category": "Kernel (XNU)"
                    },
                    {
                      "name": "- Third-party conflicts",
                      "children": [],
                      "category": "Kernel (XNU)"
                    }
                  ],
                  "category": "Kernel (XNU)"
                }
              ],
              "category": "Kernel (XNU)"
            }
          ],
          "category": "Kernel (XNU)"
        }
      ],
      "category": "Kernel (XNU)"
    },
    {
      "name": "- Boot & Firmware",
      "children": [
        {
          "name": "- Firmware / ROM",
          "children": [
            {
              "name": "- Boot ROM",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- iBoot",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- Secure Boot Chain",
              "children": [],
              "category": "Boot & Firmware"
            }
          ],
          "category": "Boot & Firmware"
        },
        {
          "name": "- Apple Silicon Boot Flow",
          "children": [
            {
              "name": "- 1TR (One True Recovery)",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- RecoveryOS",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- iBoot (M1+ variant)",
              "children": [],
              "category": "Boot & Firmware"
            }
          ],
          "category": "Boot & Firmware"
        },
        {
          "name": "- Volume & System Structure",
          "children": [
            {
              "name": "- Preboot Volume",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- System Volume (SSV)",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- Data Volume",
              "children": [],
              "category": "Boot & Firmware"
            }
          ],
          "category": "Boot & Firmware"
        },
        {
          "name": "- Intel Boot Flow",
          "children": [
            {
              "name": "- EFI",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- UEFI",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- Recovery Partition (Intel)",
              "children": [],
              "category": "Boot & Firmware"
            },
            {
              "name": "- boot.efi",
              "children": [],
              "category": "Boot & Firmware"
            }
          ],
          "category": "Boot & Firmware"
        }
      ],
      "category": "Boot & Firmware"
    },
    {
      "name": "- Launch Infrastructure",
      "children": [
        {
          "name": "- Core Binary & Service Tree",
          "children": [
            {
              "name": "- launchd (PID 1)",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- launchd bootstrap namespace",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Session Manager",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Subsystems launched by launchd",
              "children": [],
              "category": "Launch Infrastructure"
            }
          ],
          "category": "Launch Infrastructure"
        },
        {
          "name": "- Control Interface & Tools",
          "children": [
            {
              "name": "- launchctl (binary)",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- launchctl list",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- launchctl bootstrap",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- launchctl bootout",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- launchctl kickstart",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- launchctl blame",
              "children": [],
              "category": "Launch Infrastructure"
            }
          ],
          "category": "Launch Infrastructure"
        },
        {
          "name": "- Launch Job Types",
          "children": [
            {
              "name": "- Launch Daemons (System Level)",
              "children": [
                {
                  "name": "- /System/Library/LaunchDaemons",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- /Library/LaunchDaemons",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Launch Agents (System & User Level)",
              "children": [
                {
                  "name": "- /System/Library/LaunchAgents",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- /Library/LaunchAgents",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- ~/Library/LaunchAgents",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Login Items",
              "children": [
                {
                  "name": "- SMLoginItemSetEnabled (API)",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- /Library/StartupItems",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            }
          ],
          "category": "Launch Infrastructure"
        },
        {
          "name": "- Property List (.plist) Configuration Keys",
          "children": [
            {
              "name": "- Label",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Program",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- ProgramArguments",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- RunAtLoad",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- KeepAlive (with dictionary expansion)",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- MachServices",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- ThrottleInterval",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- WatchPaths",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- EnvironmentVariables",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- StartInterval",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Disabled",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- StandardOutPath",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- StandardErrorPath",
              "children": [],
              "category": "Launch Infrastructure"
            }
          ],
          "category": "Launch Infrastructure"
        },
        {
          "name": "- Legacy & Compatibility Infrastructure",
          "children": [
            {
              "name": "- /etc/rc.common",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- /etc/mach_init.d",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- StartupItemCompat service",
              "children": [],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- compatibility.sh",
              "children": [],
              "category": "Launch Infrastructure"
            }
          ],
          "category": "Launch Infrastructure"
        },
        {
          "name": "- Automated Device Enrollment (DEP)",
          "children": [
            {
              "name": "- Purpose",
              "children": [
                {
                  "name": "- Streamline enterprise/macOS/iOS onboarding",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Automate MDM enrollment at setup",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Ensure supervision of devices",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Enrollment Flow",
              "children": [
                {
                  "name": "- Device purchased through Apple/reseller",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Registered with Apple Business Manager",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- On first boot:",
                  "children": [
                    {
                      "name": "- Device contacts Apple activation servers",
                      "children": [],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Receives MDM server URL and profile",
                      "children": [],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Setup Assistant begins with restrictions",
                      "children": [],
                      "category": "Launch Infrastructure"
                    }
                  ],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Key Components",
              "children": [
                {
                  "name": "- Apple Business/School Manager",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- MDM Server",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Setup Assistant",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Features",
              "children": [
                {
                  "name": "- Mandatory and silent MDM enrollment",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Supervision enforced automatically",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Optionally disallow MDM removal",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Zero-Touch Provisioning (ZTP)",
                  "children": [
                    {
                      "name": "- Definition",
                      "children": [
                        {
                          "name": "- Auto configuration without IT interaction",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Enabled via Apple Business Manager + MDM",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Core Workflow",
                      "children": [
                        {
                          "name": "- Purchase > Register > Boot > Enroll > Apply policies",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Key Capabilities",
                      "children": [
                        {
                          "name": "- Auto-enrollment in MDM",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Auto-supervision (non-removable)",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Skippable setup screens",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Restrictions auto-applied",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Silent app installation",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Advantages",
                      "children": [
                        {
                          "name": "- Scalable: 1000s of devices",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Secure: serial-number tied",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Consistent: uniform policy",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Reduces IT errors",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Dependencies",
                      "children": [
                        {
                          "name": "- Device must be new or erased",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Internet at first boot",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Reachable and configured MDM",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Scenarios",
                      "children": [
                        {
                          "name": "- Corporate MacBook rollouts",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- iPad deployments in education",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Kiosk and retail terminals",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Fully automated onboarding flows",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    },
                    {
                      "name": "- Security and Control",
                      "children": [
                        {
                          "name": "- Enrollment cannot be bypassed",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- MDM removal can be blocked",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Supervision enforced during activation",
                          "children": [],
                          "category": "Launch Infrastructure"
                        },
                        {
                          "name": "- Audit logs",
                          "children": [],
                          "category": "Launch Infrastructure"
                        }
                      ],
                      "category": "Launch Infrastructure"
                    }
                  ],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Security",
              "children": [
                {
                  "name": "- Supervision flags",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Enrollment via organization ID",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Use Cases",
              "children": [
                {
                  "name": "- Enterprise fleets",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Education deployments",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Kiosks and POS systems",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Limitations",
              "children": [
                {
                  "name": "- Only for new/erased devices",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Cannot enroll existing personal devices",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- ABM-enrolled purchases only",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            },
            {
              "name": "- Evolution",
              "children": [
                {
                  "name": "- Not part of legacy systems",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Integrates with ADE",
                  "children": [],
                  "category": "Launch Infrastructure"
                },
                {
                  "name": "- Supports macOS, iOS, iPadOS, tvOS",
                  "children": [],
                  "category": "Launch Infrastructure"
                }
              ],
              "category": "Launch Infrastructure"
            }
          ],
          "category": "Launch Infrastructure"
        }
      ],
      "category": "Launch Infrastructure"
    },
    {
      "name": "- Logging & Audit",
      "children": [
        {
          "name": "- Unified Logging System (os_log)",
          "children": [
            {
              "name": "- log",
              "children": [
                {
                  "name": "- log show",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- log stream",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- log collect",
                  "children": [],
                  "category": "Logging & Audit"
                }
              ],
              "category": "Logging & Audit"
            },
            {
              "name": "- Logging Domains",
              "children": [
                {
                  "name": "- subsystem",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- category",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- level",
                  "children": [
                    {
                      "name": "- default",
                      "children": [],
                      "category": "Logging & Audit"
                    },
                    {
                      "name": "- info",
                      "children": [],
                      "category": "Logging & Audit"
                    },
                    {
                      "name": "- debug",
                      "children": [],
                      "category": "Logging & Audit"
                    },
                    {
                      "name": "- error",
                      "children": [],
                      "category": "Logging & Audit"
                    },
                    {
                      "name": "- fault",
                      "children": [],
                      "category": "Logging & Audit"
                    }
                  ],
                  "category": "Logging & Audit"
                }
              ],
              "category": "Logging & Audit"
            },
            {
              "name": "- Persistence Layers",
              "children": [
                {
                  "name": "- /var/db/uuidtext",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- /var/db/diagnostics",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- .tracev3 files",
                  "children": [],
                  "category": "Logging & Audit"
                }
              ],
              "category": "Logging & Audit"
            }
          ],
          "category": "Logging & Audit"
        },
        {
          "name": "- Apple System Log (ASL) \u2013 Legacy",
          "children": [
            {
              "name": "- asl.log",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- /var/log",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- syslogd",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- libasl.dylib",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- console.log",
              "children": [],
              "category": "Logging & Audit"
            }
          ],
          "category": "Logging & Audit"
        },
        {
          "name": "- Security Auditing (OpenBSM)",
          "children": [
            {
              "name": "- auditd",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- audit_control",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- /etc/security/audit_class",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- /etc/security/audit_control",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- /var/audit",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- auditreduce",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- praudit",
              "children": [],
              "category": "Logging & Audit"
            }
          ],
          "category": "Logging & Audit"
        },
        {
          "name": "- Diagnostic & Crash Reporting",
          "children": [
            {
              "name": "- sysdiagnose",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- DiagnosticReport directories",
              "children": [
                {
                  "name": "- ~/Library/Logs/DiagnosticReports",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- /Library/Logs/DiagnosticReports",
                  "children": [],
                  "category": "Logging & Audit"
                }
              ],
              "category": "Logging & Audit"
            },
            {
              "name": "- Crash Report Types",
              "children": [
                {
                  "name": "- .crash",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- .hang",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- .panic",
                  "children": [],
                  "category": "Logging & Audit"
                },
                {
                  "name": "- .spin",
                  "children": [],
                  "category": "Logging & Audit"
                }
              ],
              "category": "Logging & Audit"
            },
            {
              "name": "- reportCrash",
              "children": [],
              "category": "Logging & Audit"
            }
          ],
          "category": "Logging & Audit"
        },
        {
          "name": "- Observability Integration Points",
          "children": [
            {
              "name": "- Console.app",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- Instruments.app",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- Activity Monitor",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- spindump",
              "children": [],
              "category": "Logging & Audit"
            },
            {
              "name": "- systemstats",
              "children": [],
              "category": "Logging & Audit"
            }
          ],
          "category": "Logging & Audit"
        }
      ],
      "category": "Logging & Audit"
    },
    {
      "name": "- Security Architecture",
      "children": [
        {
          "name": "- System Integrity Protection (SIP)",
          "children": [
            {
              "name": "- csrutil",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- csr-active-config",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- SIP Flags",
              "children": [
                {
                  "name": "- CSR_ALLOW_UNRESTRICTED_FS",
                  "children": [],
                  "category": "Security Architecture"
                },
                {
                  "name": "- CSR_ALLOW_UNTRUSTED_KEXTS",
                  "children": [],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            },
            {
              "name": "- Restricted Paths",
              "children": [
                {
                  "name": "- /System",
                  "children": [],
                  "category": "Security Architecture"
                },
                {
                  "name": "- /bin",
                  "children": [],
                  "category": "Security Architecture"
                },
                {
                  "name": "- /usr",
                  "children": [],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            }
          ],
          "category": "Security Architecture"
        },
        {
          "name": "- Gatekeeper & Quarantine",
          "children": [
            {
              "name": "- spctl",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- Gatekeeper Assessment Policy",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- com.apple.quarantine",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- SecAssessment framework",
              "children": [],
              "category": "Security Architecture"
            }
          ],
          "category": "Security Architecture"
        },
        {
          "name": "- Code Signing & Notarization",
          "children": [
            {
              "name": "- codesign",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- codesign_allocate",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- ad-hoc signature",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- Developer ID signature",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- Notarytool",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- xcrun altool",
              "children": [],
              "category": "Security Architecture"
            }
          ],
          "category": "Security Architecture"
        },
        {
          "name": "- FileVault & Disk Encryption",
          "children": [
            {
              "name": "- fdesetup",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- diskutil apfs encryptVolume",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- Secure Enclave",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- PRK",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- IRK",
              "children": [],
              "category": "Security Architecture"
            }
          ],
          "category": "Security Architecture"
        },
        {
          "name": "- App Sandboxing & Entitlements",
          "children": [
            {
              "name": "- sandboxd",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- sandbox-exec",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- com.apple.security.*",
              "children": [],
              "category": "Security Architecture"
            },
            {
              "name": "- Container Paths",
              "children": [
                {
                  "name": "- ~/Library/Containers",
                  "children": [],
                  "category": "Security Architecture"
                },
                {
                  "name": "- /private/var/folders",
                  "children": [],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            }
          ],
          "category": "Security Architecture"
        },
        {
          "name": "- Transparency, Consent, and Control (TCC)",
          "children": [
            {
              "name": "- Core Daemon",
              "children": [
                {
                  "name": "- tccd",
                  "children": [
                    {
                      "name": "- Enforces runtime access control for protected services",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Validates entitlements and team identifiers",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Brokers XPC between apps and services",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Logs to unified logging: com.apple.TCC",
                      "children": [],
                      "category": "Security Architecture"
                    }
                  ],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            },
            {
              "name": "- Policy Storage",
              "children": [
                {
                  "name": "- TCC.db",
                  "children": [
                    {
                      "name": "- SQLite database scoped per user at:",
                      "children": [
                        {
                          "name": "- ~/Library/Application Support/com.apple.TCC/TCC.db",
                          "children": [],
                          "category": "Security Architecture"
                        }
                      ],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Stores Allow/Deny decisions by:",
                      "children": [
                        {
                          "name": "- service (e.g. kTCCServiceCamera)",
                          "children": [],
                          "category": "Security Architecture"
                        },
                        {
                          "name": "- bundle ID",
                          "children": [],
                          "category": "Security Architecture"
                        },
                        {
                          "name": "- user UID",
                          "children": [],
                          "category": "Security Architecture"
                        }
                      ],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Readable by apps, writable only by tccd",
                      "children": [],
                      "category": "Security Architecture"
                    }
                  ],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            },
            {
              "name": "- Policy Overrides",
              "children": [
                {
                  "name": "- TCC Profiles",
                  "children": [
                    {
                      "name": "- Delivered via MDM (e.g., Jamf, Intune)",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Uses com.apple.TCC.configuration-profile-policy payload",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Enables pre-approval without UI prompts",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Supports system-wide or user-level enforcement",
                      "children": [],
                      "category": "Security Architecture"
                    }
                  ],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            },
            {
              "name": "- App Access Prompts",
              "children": [
                {
                  "name": "- Camera",
                  "children": [
                    {
                      "name": "- Triggered by use of AVCaptureDevice API",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Requires explicit user consent via UI dialog",
                      "children": [],
                      "category": "Security Architecture"
                    }
                  ],
                  "category": "Security Architecture"
                },
                {
                  "name": "- Microphone",
                  "children": [
                    {
                      "name": "- Initiated by Core Audio capture requests",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Restricted in App Sandbox without entitlement",
                      "children": [],
                      "category": "Security Architecture"
                    }
                  ],
                  "category": "Security Architecture"
                },
                {
                  "name": "- Accessibility",
                  "children": [
                    {
                      "name": "- Covers scripting and assistive app access",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Controls use of AX APIs",
                      "children": [],
                      "category": "Security Architecture"
                    },
                    {
                      "name": "- Governed by System Settings > Privacy > Accessibility",
                      "children": [],
                      "category": "Security Architecture"
                    }
                  ],
                  "category": "Security Architecture"
                }
              ],
              "category": "Security Architecture"
            }
          ],
          "category": "Security Architecture"
        }
      ],
      "category": "Security Architecture"
    },
    {
      "name": "- System Frameworks",
      "children": [
        {
          "name": "- Core Runtime Libraries",
          "children": [
            {
              "name": "- CoreFoundation",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- Foundation",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- libdispatch",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- Objective-C Runtime (libobjc)",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreServices",
              "children": [],
              "category": "System Frameworks"
            }
          ],
          "category": "System Frameworks"
        },
        {
          "name": "- UI and App Frameworks",
          "children": [
            {
              "name": "- AppKit",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- UIKit",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreGraphics",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreAnimation",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreImage",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreText",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreAudio",
              "children": [],
              "category": "System Frameworks"
            }
          ],
          "category": "System Frameworks"
        },
        {
          "name": "- Security and Identity Frameworks",
          "children": [
            {
              "name": "- Security.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- LocalAuthentication.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- TrustEvaluationAgent",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- KeychainCore",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- Authorization Services",
              "children": [],
              "category": "System Frameworks"
            }
          ],
          "category": "System Frameworks"
        },
        {
          "name": "- Driver and Hardware Abstraction",
          "children": [
            {
              "name": "- IOKit.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- DriverKit.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- HIDManager",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- IOReport",
              "children": [],
              "category": "System Frameworks"
            }
          ],
          "category": "System Frameworks"
        },
        {
          "name": "- System Services and Background APIs",
          "children": [
            {
              "name": "- PCSC.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- LaunchServices.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- SystemConfiguration.framework",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- CoreWLAN",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- NetFS",
              "children": [],
              "category": "System Frameworks"
            },
            {
              "name": "- DiskArbitration.framework",
              "children": [],
              "category": "System Frameworks"
            }
          ],
          "category": "System Frameworks"
        }
      ],
      "category": "System Frameworks"
    },
    {
      "name": "- User-Space Processes",
      "children": [
        {
          "name": "- Core Session & Login Managers",
          "children": [
            {
              "name": "- loginwindow",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- launchservicesd",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- systemstats",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- UserEventAgent",
              "children": [
                {
                  "name": "- UserEventAgent",
                  "children": [
                    {
                      "name": "- Power events",
                      "children": [],
                      "category": "User-Space Processes"
                    },
                    {
                      "name": "- Thermal events",
                      "children": [],
                      "category": "User-Space Processes"
                    },
                    {
                      "name": "- App lifecycle notifications",
                      "children": [],
                      "category": "User-Space Processes"
                    },
                    {
                      "name": "- Sleep/Wake coordination",
                      "children": [],
                      "category": "User-Space Processes"
                    },
                    {
                      "name": "- Apple Push Notification Service (APNS)",
                      "children": [],
                      "category": "User-Space Processes"
                    }
                  ],
                  "category": "User-Space Processes"
                }
              ],
              "category": "User-Space Processes"
            },
            {
              "name": "- backgroundtaskmanagementagent",
              "children": [],
              "category": "User-Space Processes"
            }
          ],
          "category": "User-Space Processes"
        },
        {
          "name": "- UI Display Layer",
          "children": [
            {
              "name": "- WindowServer",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- CoreGraphics Services",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- SkyLight",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- Dock",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- Finder",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- ControlCenter",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- NotificationCenter",
              "children": [],
              "category": "User-Space Processes"
            }
          ],
          "category": "User-Space Processes"
        },
        {
          "name": "- User Workspace Daemons",
          "children": [
            {
              "name": "- SystemUIServer",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- Spotlight",
              "children": [
                {
                  "name": "- mds",
                  "children": [],
                  "category": "User-Space Processes"
                },
                {
                  "name": "- mdworker",
                  "children": [],
                  "category": "User-Space Processes"
                }
              ],
              "category": "User-Space Processes"
            },
            {
              "name": "- QuickLookUIService",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- SiriNCService",
              "children": [],
              "category": "User-Space Processes"
            },
            {
              "name": "- nursessiond",
              "children": [],
              "category": "User-Space Processes"
            }
          ],
          "category": "User-Space Processes"
        }
      ],
      "category": "User-Space Processes"
    },
    {
      "name": "(also hooks here due to per-user daemon context)",
      "children": [
        {
          "name": "- Session-Scoped Infrastructure",
          "children": [
            {
              "name": "- coreservicesd",
              "children": [],
              "category": null
            },
            {
              "name": "- pboard",
              "children": [],
              "category": null
            },
            {
              "name": "- distnoted",
              "children": [],
              "category": null
            },
            {
              "name": "- fontd",
              "children": [],
              "category": null
            },
            {
              "name": "- cfprefsd",
              "children": [],
              "category": null
            },
            {
              "name": "- UserEventAgent",
              "children": [],
              "category": null
            },
            {
              "name": "- tccd",
              "children": [],
              "category": null
            },
            {
              "name": "- distnoted",
              "children": [],
              "category": null
            }
          ],
          "category": null
        },
        {
          "name": "- Login Items & Background Apps",
          "children": [
            {
              "name": "- SMLoginItemSetEnabled",
              "children": [],
              "category": null
            },
            {
              "name": "- launchctl-loaded User Agents",
              "children": [],
              "category": null
            },
            {
              "name": "- LSBackgroundOnly",
              "children": [],
              "category": null
            },
            {
              "name": "- LoginItems (LaunchServices)",
              "children": [],
              "category": null
            },
            {
              "name": "- Managed Login Items (MDM-controlled)",
              "children": [],
              "category": null
            }
          ],
          "category": null
        },
        {
          "name": "- nursessiond",
          "children": [
            {
              "name": "- \ud83e\udde9 Core Responsibilities",
              "children": [
                {
                  "name": "- Session Lifecycle Mgmt",
                  "children": [
                    {
                      "name": "- Interfaces with loginwindow",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- Fast User Switching",
                  "children": [
                    {
                      "name": "- Manages session states",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- Resource Quotas",
                  "children": [
                    {
                      "name": "- Tracks CPU/mem/I/O caps",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                }
              ],
              "category": null
            },
            {
              "name": "- \ud83d\udd12 Security & Enforcement",
              "children": [
                {
                  "name": "- UID/GID Validation",
                  "children": [
                    {
                      "name": "- Confirms session ownership",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- App Sandbox",
                  "children": [
                    {
                      "name": "- Applies container restrictions",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- TCC Enforcement",
                  "children": [
                    {
                      "name": "- Governs user privacy controls",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- XPC Hardening",
                  "children": [
                    {
                      "name": "- Limits entitlement scope",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                }
              ],
              "category": null
            },
            {
              "name": "- \ud83d\udd04 Inter-process Interactions",
              "children": [
                {
                  "name": "- User Session Lifecycle",
                  "children": [
                    {
                      "name": "- loginwindow",
                      "children": [
                        {
                          "name": "- \u2194 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Activates/deactivates sessions",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- hidd",
                      "children": [
                        {
                          "name": "- \u2190 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- User input presence",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- powerd",
                      "children": [
                        {
                          "name": "- \u2194 XPC [perf]",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Coordinates sleep/wake",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- Notifications & Messaging",
                  "children": [
                    {
                      "name": "- distnoted",
                      "children": [
                        {
                          "name": "- \u2192 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Routes per-session notifications",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- coreservicesd",
                      "children": [
                        {
                          "name": "- \u2192 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Locale/user preferences",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- backboardd",
                      "children": [
                        {
                          "name": "- \u2192 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- SpringBoard session updates",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- App Context",
                  "children": [
                    {
                      "name": "- launchservicesd",
                      "children": [
                        {
                          "name": "- \u2194 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Resolves app UID context",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- wifid",
                      "children": [
                        {
                          "name": "- \u2192 XPC",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Captive portal coordination",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- Security Integration",
                  "children": [
                    {
                      "name": "- securityd",
                      "children": [
                        {
                          "name": "- \u2194 XPC [sec]",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Credential and session tokens",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- reportcrash",
                      "children": [
                        {
                          "name": "- \u2192 Signal",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Crash diagnostics",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- Telemetry",
                  "children": [
                    {
                      "name": "- sysmond",
                      "children": [
                        {
                          "name": "- + Perf",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Live resource metrics",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    },
                    {
                      "name": "- systemstatsd",
                      "children": [
                        {
                          "name": "- \u2194 Data",
                          "children": [],
                          "category": null
                        },
                        {
                          "name": "- Historical session metrics",
                          "children": [],
                          "category": null
                        }
                      ],
                      "category": null
                    }
                  ],
                  "category": null
                }
              ],
              "category": null
            },
            {
              "name": "- \ud83e\udde0 System Dependencies",
              "children": [
                {
                  "name": "- launchd [dep]",
                  "children": [
                    {
                      "name": "- Bootstraps daemon",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- watchdogd [sec]",
                  "children": [
                    {
                      "name": "- Monitors and recovers daemon",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                },
                {
                  "name": "- accountsd [dep]",
                  "children": [
                    {
                      "name": "- Syncs session attributes",
                      "children": [],
                      "category": null
                    }
                  ],
                  "category": null
                }
              ],
              "category": null
            }
          ],
          "category": null
        }
      ],
      "category": null
    },
    {
      "name": "- Applications & GUI",
      "children": [
        {
          "name": "- Display & Compositor Stack",
          "children": [
            {
              "name": "- WindowServer",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- CoreGraphics",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- CoreAnimation",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- SkyLight",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- Quartz Compositor",
              "children": [],
              "category": "Applications & GUI"
            }
          ],
          "category": "Applications & GUI"
        },
        {
          "name": "- User Interface Shell Components",
          "children": [
            {
              "name": "- SystemUIServer",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- Dock",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- Finder",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- ControlCenter",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- Notification Center",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- Spotlight UI Agent",
              "children": [
                {
                  "name": "- Spotlight.app",
                  "children": [],
                  "category": "Applications & GUI"
                },
                {
                  "name": "- QuickLookUIService",
                  "children": [],
                  "category": "Applications & GUI"
                }
              ],
              "category": "Applications & GUI"
            }
          ],
          "category": "Applications & GUI"
        },
        {
          "name": "- Framework-Level GUI APIs",
          "children": [
            {
              "name": "- AppKit",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- UIKit",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- CoreImage",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- CoreText",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- CoreDisplay",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- NSWorkspace",
              "children": [],
              "category": "Applications & GUI"
            }
          ],
          "category": "Applications & GUI"
        },
        {
          "name": "- Login Session & Desktop Context",
          "children": [
            {
              "name": "- loginwindow",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- launchservicesd",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- backgroundtaskmanagementagent",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- pboard",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- distnoted",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- cfprefsd",
              "children": [],
              "category": "Applications & GUI"
            }
          ],
          "category": "Applications & GUI"
        },
        {
          "name": "- System Menu & Status Services",
          "children": [
            {
              "name": "- MenuExtras framework",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- menuBar.db",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- NSStatusItem",
              "children": [],
              "category": "Applications & GUI"
            },
            {
              "name": "- AccessibilityServer",
              "children": [],
              "category": "Applications & GUI"
            }
          ],
          "category": "Applications & GUI"
        }
      ],
      "category": "Applications & GUI"
    },
    {
      "name": "- Forensics & Monitoring",
      "children": [
        {
          "name": "- Endpoint Security Framework (ESF)",
          "children": [
            {
              "name": "- EndpointSecurity.framework",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- eslogger",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- es_consume",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- event types",
              "children": [
                {
                  "name": "- exec",
                  "children": [],
                  "category": "Forensics & Monitoring"
                },
                {
                  "name": "- fork",
                  "children": [],
                  "category": "Forensics & Monitoring"
                },
                {
                  "name": "- open",
                  "children": [],
                  "category": "Forensics & Monitoring"
                },
                {
                  "name": "- mmap",
                  "children": [],
                  "category": "Forensics & Monitoring"
                },
                {
                  "name": "- kill",
                  "children": [],
                  "category": "Forensics & Monitoring"
                },
                {
                  "name": "- unlink",
                  "children": [],
                  "category": "Forensics & Monitoring"
                }
              ],
              "category": "Forensics & Monitoring"
            }
          ],
          "category": "Forensics & Monitoring"
        },
        {
          "name": "- File System Event Tracking",
          "children": [
            {
              "name": "- fsevents",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- FSEventStream API",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- /.fseventsd/",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- fseventsd",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- FileWatcher agents",
              "children": [],
              "category": "Forensics & Monitoring"
            }
          ],
          "category": "Forensics & Monitoring"
        },
        {
          "name": "- Execution Chain & Binary Monitoring",
          "children": [
            {
              "name": "- execsnoop",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- opensnoop",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- auditd",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- fs_usage",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- sandbox-exec",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- launchd job tree traversal",
              "children": [],
              "category": "Forensics & Monitoring"
            }
          ],
          "category": "Forensics & Monitoring"
        },
        {
          "name": "- System Dump & Panic Analysis",
          "children": [
            {
              "name": "- spindump",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- sample",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- /Library/Logs/DiagnosticReports/*.panic",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- sysdiagnose",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- crashinspector",
              "children": [],
              "category": "Forensics & Monitoring"
            }
          ],
          "category": "Forensics & Monitoring"
        },
        {
          "name": "- Forensic Artifacts & Audit Trails",
          "children": [
            {
              "name": "- /var/audit",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- auditreduce",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- Apple System Logger",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- /var/log/install.log",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- com.apple.quarantine",
              "children": [],
              "category": "Forensics & Monitoring"
            },
            {
              "name": "- tracev3",
              "children": [],
              "category": "Forensics & Monitoring"
            }
          ],
          "category": "Forensics & Monitoring"
        },
        {
          "name": "- TCC & Privacy Monitoring",
          "children": [
            {
              "name": "- Session transitions monitored (via nursessiond)",
              "children": [],
              "category": "Forensics & Monitoring"
            }
          ],
          "category": "Forensics & Monitoring"
        }
      ],
      "category": "Forensics & Monitoring"
    },
    {
      "name": "- Observability Tools",
      "children": [
        {
          "name": "- Interactive Monitoring Interfaces",
          "children": [
            {
              "name": "- Activity Monitor",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- Console.app",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- Instruments.app",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- spindump viewer",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- powermetrics (viewer shell)",
              "children": [],
              "category": "Observability Tools"
            }
          ],
          "category": "Observability Tools"
        },
        {
          "name": "- Performance Tracers & System Profilers",
          "children": [
            {
              "name": "- dtrace",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- Instruments.app (CLI integration)",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- sample",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- spindump",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- top",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- vm_stat",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- system_profiler",
              "children": [],
              "category": "Observability Tools"
            }
          ],
          "category": "Observability Tools"
        },
        {
          "name": "- File & Process Observability",
          "children": [
            {
              "name": "- fs_usage",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- opensnoop",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- execsnoop",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- iopending",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- iotop",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- Apple System Logger",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- osquery",
              "children": [],
              "category": "Observability Tools"
            }
          ],
          "category": "Observability Tools"
        },
        {
          "name": "- Hardware & Power Inspection",
          "children": [
            {
              "name": "- powermetrics",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- systemstats",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- pmset -g",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- ioreg",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- powertop",
              "children": [],
              "category": "Observability Tools"
            }
          ],
          "category": "Observability Tools"
        },
        {
          "name": "- Frameworks and CLI Interfaces",
          "children": [
            {
              "name": "- XPC Observer",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- os_signpost",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- Activity Tracing Framework",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- sysdiagnose",
              "children": [],
              "category": "Observability Tools"
            },
            {
              "name": "- MTLCapture",
              "children": [],
              "category": "Observability Tools"
            }
          ],
          "category": "Observability Tools"
        }
      ],
      "category": "Observability Tools"
    },
    {
      "name": "- Networking Stack",
      "children": [
        {
          "name": "- Interface & Configuration Daemons",
          "children": [
            {
              "name": "- configd",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- networkd",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- nehelper",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- NEAgent",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- IPConfiguration",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- bootpd",
              "children": [],
              "category": "Networking Stack"
            }
          ],
          "category": "Networking Stack"
        },
        {
          "name": "- Discovery & Name Resolution",
          "children": [
            {
              "name": "- mDNSResponder",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- dns_sd",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- discoveryd",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- /etc/resolv.conf",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- DNSConfiguration.plist",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- DNS-SD (DNS Service Discovery)",
              "children": [
                {
                  "name": "- Purpose",
                  "children": [
                    {
                      "name": "- Discover services on a local network",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Zero configuration required",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Used with mDNS in local environments",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Core Concepts",
                  "children": [
                    {
                      "name": "- Service Name: <Instance>.<Service>.<Protocol>.local.",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Works over mDNS or standard DNS",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Uses PTR, SRV, TXT, A/AAAA records",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Record Types",
                  "children": [
                    {
                      "name": "- PTR",
                      "children": [
                        {
                          "name": "- Lists all available instances of a service",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- SRV",
                      "children": [
                        {
                          "name": "- Maps service name to hostname + port",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- TXT",
                      "children": [
                        {
                          "name": "- Key-value metadata (e.g., path=/printer)",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- A / AAAA",
                      "children": [
                        {
                          "name": "- Resolves hostname to IP address",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Discovery Flow",
                  "children": [
                    {
                      "name": "- Client sends PTR query for service type (e.g., _http._tcp.local.)",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Gets list of service instances",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Sends SRV + TXT query for each instance",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Resolves hostname to IP",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Common Services",
                  "children": [
                    {
                      "name": "- _http._tcp.local.",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- _ipp._tcp.local.",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- _airplay._tcp.local.",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- _raop._tcp.local.",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- _afpovertcp._tcp.local.",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- _companion-link._tcp.local.",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Apple Ecosystem",
                  "children": [
                    {
                      "name": "- Backbone of Bonjour",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Powers AirDrop, AirPlay, AirPrint, HomeKit",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Exposed via NSNetService / Network.framework",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Used with Wi-Fi P2P, BLE for discovery + transport",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            }
          ],
          "category": "Networking Stack"
        },
        {
          "name": "- Network Extension Framework",
          "children": [
            {
              "name": "- NetworkExtension.framework",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- VPN plugins",
              "children": [
                {
                  "name": "- App Proxy Provider",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Packet Tunnel Provider",
                  "children": [],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- ContentFilterProvider",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- DNS Proxy Provider",
              "children": [],
              "category": "Networking Stack"
            }
          ],
          "category": "Networking Stack"
        },
        {
          "name": "- Firewall & Packet Filtering",
          "children": [
            {
              "name": "- Packet Filter (pf)",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- pfctl",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- pf.conf",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- socketfilterfw",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- /etc/pf.anchors",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- anchor loading order",
              "children": [],
              "category": "Networking Stack"
            }
          ],
          "category": "Networking Stack"
        },
        {
          "name": "- Sockets & Transport Layer",
          "children": [
            {
              "name": "- XNU Socket Interface",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- ifconfig",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- netstat",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- route",
              "children": [],
              "category": "Networking Stack"
            },
            {
              "name": "- ipconfig",
              "children": [],
              "category": "Networking Stack"
            }
          ],
          "category": "Networking Stack"
        },
        {
          "name": "- Wi-Fi P2P (Wi-Fi Direct)",
          "children": [
            {
              "name": "- Definition",
              "children": [
                {
                  "name": "- Peer-to-peer wireless communication",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- No access point required",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Devices connect directly using 802.11",
                  "children": [],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- Roles",
              "children": [
                {
                  "name": "- Group Owner (GO)",
                  "children": [
                    {
                      "name": "- Acts like an access point",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Assigns IP via DHCP",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Client",
                  "children": [
                    {
                      "name": "- Joins the GO\u2019s group",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Communicates over local Wi-Fi",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- Protocols",
              "children": [
                {
                  "name": "- IEEE 802.11 with P2P extensions",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- WPA2 / WPA3 for encryption",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- WPS for setup (PBC, PIN)",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- DHCP for IP assignment",
                  "children": [],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- Discovery & Negotiation",
              "children": [
                {
                  "name": "- Discovery Phase",
                  "children": [
                    {
                      "name": "- Listen State",
                      "children": [
                        {
                          "name": "- Device listens for P2P probe requests",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Find State",
                      "children": [
                        {
                          "name": "- Actively sends probe requests to locate peers",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Probe Response",
                      "children": [
                        {
                          "name": "- Peer replies with P2P capability information",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Service Discovery",
                      "children": [
                        {
                          "name": "- Bonjour, DNS-SD, or custom protocols",
                          "children": [],
                          "category": "Networking Stack"
                        },
                        {
                          "name": "- Allows querying services before connection",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Negotiation Phase",
                  "children": [
                    {
                      "name": "- GO Negotiation Request",
                      "children": [
                        {
                          "name": "- Sent by initiating device",
                          "children": [],
                          "category": "Networking Stack"
                        },
                        {
                          "name": "- Proposes intent to be Group Owner (GO)",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- GO Intent Value",
                      "children": [
                        {
                          "name": "- Range 0\u201315; higher wins",
                          "children": [],
                          "category": "Networking Stack"
                        },
                        {
                          "name": "- Tie-breaker bit used if equal",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- GO Negotiation Response & Confirmation",
                      "children": [
                        {
                          "name": "- Confirms roles and connection parameters",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Group Formation",
                  "children": [
                    {
                      "name": "- GO starts P2P Group",
                      "children": [
                        {
                          "name": "- Acts like a soft AP",
                          "children": [],
                          "category": "Networking Stack"
                        },
                        {
                          "name": "- Sends beacon frames",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Client joins group",
                      "children": [
                        {
                          "name": "- Connects using WPA2",
                          "children": [],
                          "category": "Networking Stack"
                        },
                        {
                          "name": "- Gets IP via DHCP from GO",
                          "children": [],
                          "category": "Networking Stack"
                        }
                      ],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Role Flexibility",
                  "children": [
                    {
                      "name": "- Devices can retry negotiation",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Can dynamically switch GO/Client roles",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Autonomous GO possible (predefined roles)",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Service Discovery Details",
                  "children": [
                    {
                      "name": "- Uses DNS-SD, mDNS, UPnP",
                      "children": [],
                      "category": "Networking Stack"
                    },
                    {
                      "name": "- Reduces need to connect before discovering features",
                      "children": [],
                      "category": "Networking Stack"
                    }
                  ],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- Use Cases",
              "children": [
                {
                  "name": "- AirDrop (macOS / iOS)",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Apple Watch pairing",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Android Nearby Share",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Wi-Fi Direct printing",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- IoT device pairing",
                  "children": [],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- Apple Integration",
              "children": [
                {
                  "name": "- Uses Wi-Fi P2P behind MultipeerConnectivity",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- No direct access to raw P2P APIs",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Often paired with Bluetooth for proximity + trigger",
                  "children": [],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            },
            {
              "name": "- Features",
              "children": [
                {
                  "name": "- Encrypted communication",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Works without infrastructure",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Supports concurrent P2P and normal Wi-Fi connections",
                  "children": [],
                  "category": "Networking Stack"
                },
                {
                  "name": "- Can span multiple groups",
                  "children": [],
                  "category": "Networking Stack"
                }
              ],
              "category": "Networking Stack"
            }
          ],
          "category": "Networking Stack"
        }
      ],
      "category": "Networking Stack"
    }
  ],
  "category": null
};
(function(treeData) {
  const dx = 20;
  const dy = 400;
  const tree = d3.tree().nodeSize([dx, dy]);

  const root = d3.hierarchy(treeData);
  root.x0 = 0;
  root.y0 = 0;

  const diagonal = d3.linkHorizontal().x(d => d.y).y(d => d.x);

  const svg = d3.select("body").append("svg")
    .attr("width", window.innerWidth)
    .attr("height", window.innerHeight)
    .call(d3.zoom().on("zoom", function (event) {
      g.attr("transform", event.transform);
    }));

  const g = svg.append("g").attr("transform", "translate(60,40)");
  const gLink = g.append("g").attr("fill", "none").attr("stroke-width", 1.5);
  const gNode = g.append("g").attr("cursor", "pointer").attr("pointer-events", "all");

  let i = 0;
  root.children.forEach(d => collapseDepth(d, 2));
  update(root);

  function collapseDepth(d, depth) {
    if (d.depth >= depth && d.children) {
      d._children = d.children;
      d._children.forEach(child => collapseDepth(child, depth));
      d.children = null;
    } else if (d.children) {
      d.children.forEach(child => collapseDepth(child, depth));
    }
  }

  function update(source) {
    const nodes = root.descendants().reverse();
    const links = root.links();

    tree(root);

    const transition = svg.transition().duration(750);

    const node = gNode.selectAll("g")
      .data(nodes, d => d.id || (d.id = ++i));

    const nodeEnter = node.enter().append("g")
      .attr("class", "node")
      .attr("transform", d => `translate(${source.y0},${source.x0})`)
      .on("click", (event, d) => {
        d.children = d.children ? null : d._children;
        update(d);
      });

    nodeEnter.append("circle")
      .attr("r", 4)
      .attr("fill", d => colorMap[d.data?.category] || "#999");

    nodeEnter.append("text")
      .attr("dy", "0.31em")
      .attr("x", 10)
      .attr("text-anchor", "start")
      .style("font-size", d => d.depth === 1 ? "16px" :
                               d.depth === 2 ? "14px" : "12px")
      .style("font-weight", d => d.children || d._children ? "bold" : "normal")
      .text(d => {
        const name = d.data.name.replace(/^-+\s*/, '');
        return name.length > 60 ? name.slice(0, 57) + "..." : name;
      })
      .clone(true).lower()
      .attr("stroke", "black");

    node.merge(nodeEnter).transition(transition)
      .attr("transform", d => `translate(${d.y},${d.x})`);

    node.exit().transition(transition).remove()
      .attr("transform", d => `translate(${source.y},${source.x})`)
      .style("fill-opacity", 0);

    gLink.selectAll("path")
      .data(links, d => d.target.id)
      .join("path")
      .transition(transition)
      .attr("stroke", "#888")
      .attr("d", diagonal);

    root.each(d => {
      d.x0 = d.x;
      d.y0 = d.y;
    });
  }
});
</script>
</html>
